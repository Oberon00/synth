<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>src/cmdline.cpp</title>
        <link rel="stylesheet" href="../codestyle-colorful.css">
    </head>
    <body>
        <div class="highlight"><pre><span id="1L" class="Ln"><a href="cmdline.hpp.html"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">"cmdline.hpp"</span></a></span>
<span id="2L" class="Ln"></span>
<span id="3L" class="Ln"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;</span><span class="cpf">climits</span><span class="cpf">></span></span>
<span id="4L" class="Ln"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;</span><span class="cpf">cstring</span><span class="cpf">></span></span>
<span id="5L" class="Ln"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;</span><span class="cpf">stdexcept</span><span class="cpf">></span></span>
<span id="6L" class="Ln"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;</span><span class="cpf">thread</span><span class="cpf">></span></span>
<span id="7L" class="Ln"></span>
<span id="8L" class="Ln"><span class="kd">using</span> <span class="kd">namespace</span> <a href="cmdline.hpp.html#synth" class="nn">synth</a>;</span>
<span id="9L" class="Ln"></span>
<span id="10L" class="Ln"><span class="kt">unsigned</span> <span class="kd">const</span> <span class="def decl vg" id="kDefaultMaxIdSz">kDefaultMaxIdSz</span> <span class="p">=</span> <span class="m">128</span>;</span>
<span id="11L" class="Ln"></span>
<span id="12L" class="Ln"><span class="kd">static</span> <span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nf" id="getOptVal:const-char*const*">getOptVal</span><span class="p">(</span><span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nv">opt</span><span class="p">)</span></span>
<span id="13L" class="Ln"><span class="p">{</span></span>
<span id="14L" class="Ln">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="#12L" class="nv">opt</a><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="p">)</span></span>
<span id="15L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Missing value for "</span> <span class="p">+</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string" class="nc">string</a><span class="p">(</span><a href="#12L" class="nv">opt</a><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">;</span></span>
<span id="16L" class="Ln">    <span class="k">return</span> <a href="#12L" class="nv">opt</a><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="p">;</span></span>
<span id="17L" class="Ln"><span class="p">}</span></span>
<span id="18L" class="Ln"></span>
<span id="19L" class="Ln"><span class="kd">static</span> <span class="kt">void</span> <span class="def decl nf" id="getOptVal:const-char*const*,const-char*&amp;">getOptVal</span><span class="p">(</span><span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nv">opt</span><span class="p">,</span> <span class="kt">char</span> <span class="kd">const</span><span class="p">*</span><span class="p">&amp;</span> <span class="def decl nv">out</span><span class="p">)</span></span>
<span id="20L" class="Ln"><span class="p">{</span></span>
<span id="21L" class="Ln">    <span class="k">if</span> <span class="p">(</span><a href="#19L" class="nv">out</a><span class="p">)</span></span>
<span id="22L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Duplicate option "</span> <span class="p">+</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string" class="nc">string</a><span class="p">(</span><a href="#19L" class="nv">opt</a><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">;</span></span>
<span id="23L" class="Ln">    <a href="#19L" class="nv">out</a> <span class="o">=</span> <a href="#getOptVal:const-char*const*" class="nf">getOptVal</a><span class="p">(</span><a href="#19L" class="nv">opt</a><span class="p">)</span><span class="p">;</span></span>
<span id="24L" class="Ln"><span class="p">}</span></span>
<span id="25L" class="Ln"></span>
<span id="26L" class="Ln"><span class="kd">static</span> <span class="kt">unsigned</span> <span class="def decl nf" id="getUintOptVal:const-char*const*">getUintOptVal</span><span class="p">(</span><span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nv">opt</span><span class="p">)</span></span>
<span id="27L" class="Ln"><span class="p">{</span></span>
<span id="28L" class="Ln">    <span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nv">nStr</span> <span class="p">=</span> <a href="#getOptVal:const-char*const*" class="nf">getOptVal</a><span class="p">(</span><a href="#26L" class="nv">opt</a><span class="p">)</span><span class="p">;</span></span>
<span id="29L" class="Ln">    <span class="kt">int</span> <span class="def decl nv">n</span><span class="p">;</span></span>
<span id="30L" class="Ln">    <span class="k">try</span> <span class="p">{</span></span>
<span id="31L" class="Ln">        <a href="#29L" class="nv">n</a> <span class="o">=</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string/stol" class="nf">stoi</a><span class="p">(</span><a href="#28L" class="nv">nStr</a><span class="p">)</span><span class="p">;</span></span>
<span id="32L" class="Ln">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/exception" class="nc">exception</a> <span class="kd">const</span><span class="p">&amp;</span> <span class="def decl nv">e</span><span class="p">)</span> <span class="p">{</span></span>
<span id="33L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span></span>
<span id="34L" class="Ln">            <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string" class="nc">string</a><span class="p">(</span><span class="s">"Integer expected for "</span><span class="p">)</span> <span class="p">+</span> <a href="#26L" class="nv">opt</a><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span> <span class="s">": "</span> <span class="p">+</span> <a href="#32L" class="nv">e</a><span class="p">.</span><a href="http://en.cppreference.com/w/cpp/error/exception/what" class="nf">what</a><span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">;</span></span>
<span id="35L" class="Ln">    <span class="p">}</span></span>
<span id="36L" class="Ln">    <span class="k">if</span> <span class="p">(</span><a href="#29L" class="nv">n</a> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span></span>
<span id="37L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span></span>
<span id="38L" class="Ln">            <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string" class="nc">string</a><span class="p">(</span><span class="s">"Value for "</span><span class="p">)</span> <span class="p">+</span> <a href="#26L" class="nv">opt</a><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span> <span class="s">" must not be negative."</span><span class="p">)</span><span class="p">;</span></span>
<span id="39L" class="Ln">    <span class="p">}</span></span>
<span id="40L" class="Ln">    <span class="k">return</span> <span class="k">static_cast</span><span class="p">&lt;</span><span class="kt">unsigned</span><span class="p">></span><span class="p">(</span><a href="#29L" class="nv">n</a><span class="p">)</span><span class="p">;</span></span>
<span id="41L" class="Ln"><span class="p">}</span></span>
<span id="42L" class="Ln"></span>
<span id="43L" class="Ln"><a href="cmdline.hpp.html#synth::CmdLineArgs" class="nc">CmdLineArgs</a> <a href="cmdline.hpp.html#synth::CmdLineArgs" class="nc">CmdLineArgs</a><span class="p">::</span><span class="def decl nf" id="synth::CmdLineArgs::parse:int,const-char*const*">parse</span><span class="p">(</span><span class="kt">int</span> <span class="def decl nv">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="kd">const</span><span class="p">*</span> <span class="kd">const</span><span class="p">*</span> <span class="def decl nv">argv</span><span class="p">)</span></span>
<span id="44L" class="Ln"><span class="p">{</span></span>
<span id="45L" class="Ln">    <span class="k">if</span> <span class="p">(</span><a href="#43L" class="nv">argc</a> <span class="o">&lt;</span> <span class="m">3</span><span class="p">)</span></span>
<span id="46L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Too few arguments."</span><span class="p">)</span><span class="p">;</span></span>
<span id="47L" class="Ln">    <a href="cmdline.hpp.html#synth::CmdLineArgs" class="nc">CmdLineArgs</a> <span class="def decl nv">r</span> <span class="p">=</span> <span class="p">{</span><span class="p">}</span><span class="p">;</span></span>
<span id="48L" class="Ln">    <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::maxIdSz" class="vi">maxIdSz</a> <span class="o">=</span> <a href="#kDefaultMaxIdSz" class="vg">kDefaultMaxIdSz</a><span class="p">;</span></span>
<span id="49L" class="Ln">    <span class="kt">bool</span> <span class="def decl nv">maxIdSzFound</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span></span>
<span id="50L" class="Ln">    <span class="kt">bool</span> <span class="def decl nv">foundCmd</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span></span>
<span id="51L" class="Ln">    <span class="kt">int</span> <span class="def decl nv">i</span><span class="p">;</span></span>
<span id="52L" class="Ln">    <span class="k">for</span> <span class="p">(</span><a href="#51L" class="nv">i</a> <span class="o">=</span> <span class="m">1</span><span class="p">;</span> <a href="#51L" class="nv">i</a> <span class="o">&lt;</span> <a href="#43L" class="nv">argc</a><span class="p">;</span> <span class="o">++</span><a href="#51L" class="nv">i</a><span class="p">)</span> <span class="p">{</span></span>
<span id="53L" class="Ln">        <span class="k">if</span> <span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">'-'</span><span class="p">)</span> <span class="p">{</span></span>
<span id="54L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::inOutDirs" class="vi">inOutDirs</a><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="p">{</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="kc">nullptr</span><span class="p">}</span><span class="p">)</span><span class="p">;</span></span>
<span id="55L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"-e"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="56L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::clangArgs" class="vi">clangArgs</a><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><a href="#getOptVal:const-char*const*" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">)</span><span class="p">)</span><span class="p">;</span></span>
<span id="57L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"-t"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="58L" class="Ln">             <a href="#getOptVal:const-char*const*,const-char*&amp;" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">,</span> <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::templateFile" class="vi">templateFile</a><span class="p">)</span><span class="p">;</span></span>
<span id="59L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"-j"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="60L" class="Ln">            <span class="k">if</span> <span class="p">(</span><a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::nThreads" class="vi">nThreads</a> <span class="o">!=</span> <span class="m">0</span><span class="p">)</span></span>
<span id="61L" class="Ln">                <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Duplicate option -j."</span><span class="p">)</span><span class="p">;</span></span>
<span id="62L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::nThreads" class="vi">nThreads</a> <span class="o">=</span> <a href="#getUintOptVal:const-char*const*" class="nf">getUintOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">)</span><span class="p">;</span></span>
<span id="63L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"--max-id-sz"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="64L" class="Ln">            <span class="k">if</span> <span class="p">(</span><a href="#49L" class="nv">maxIdSzFound</a><span class="p">)</span></span>
<span id="65L" class="Ln">                <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Duplicate option --max-id-sz."</span><span class="p">)</span><span class="p">;</span></span>
<span id="66L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::maxIdSz" class="vi">maxIdSz</a> <span class="o">=</span> <a href="#getUintOptVal:const-char*const*" class="nf">getUintOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">)</span><span class="p">;</span></span>
<span id="67L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="68L" class="Ln">            <span class="k">if</span> <span class="p">(</span><a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::inOutDirs" class="vi">inOutDirs</a><span class="p">.</span><span class="nf">empty</span><span class="p">(</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="69L" class="Ln">                <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span></span>
<span id="70L" class="Ln">                    <span class="s">"-o without preceeding input directory"</span><span class="p">)</span><span class="p">;</span></span>
<span id="71L" class="Ln">            <span class="p">}</span></span>
<span id="72L" class="Ln">            <a href="#getOptVal:const-char*const*,const-char*&amp;" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">,</span> <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::inOutDirs" class="vi">inOutDirs</a><span class="p">.</span><span class="nf">back</span><span class="p">(</span><span class="p">)</span><span class="p">.</span><span class="vi">second</span><span class="p">)</span><span class="p">;</span></span>
<span id="73L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"--doxytags"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="74L" class="Ln">            <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/utility/pair" class="nc">pair</a><span class="p">&lt;</span><span class="kt">char</span> <span class="kd">const</span><span class="p">*</span><span class="p">,</span> <span class="kt">char</span> <span class="kd">const</span><span class="p">*</span><span class="p">></span> <span class="def decl nv">tagOpts</span><span class="p">;</span></span>
<span id="75L" class="Ln">            <a href="#getOptVal:const-char*const*,const-char*&amp;" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">,</span> <a href="#74L" class="nv">tagOpts</a><span class="p">.</span><span class="vi">first</span><span class="p">)</span><span class="p">;</span></span>
<span id="76L" class="Ln">            <a href="#getOptVal:const-char*const*,const-char*&amp;" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">,</span> <a href="#74L" class="nv">tagOpts</a><span class="p">.</span><span class="vi">second</span><span class="p">)</span><span class="p">;</span></span>
<span id="77L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::doxyTagFiles" class="vi">doxyTagFiles</a><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">move</span><span class="p">(</span><a href="#74L" class="nv">tagOpts</a><span class="p">)</span><span class="p">)</span><span class="p">;</span></span>
<span id="78L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"--cmd"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="79L" class="Ln">            <span class="c">// These come before any extra-args, thus use insert(begin(), ...).</span></span>
<span id="80L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::clangArgs" class="vi">clangArgs</a><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::clangArgs" class="vi">clangArgs</a><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="p">)</span><span class="p">,</span> <a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a> <span class="o">+</span> <span class="m">1</span><span class="p">,</span> <a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#43L" class="nv">argc</a><span class="p">)</span><span class="p">;</span></span>
<span id="81L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::nClangArgs" class="vi">nClangArgs</a> <span class="o">=</span> <a href="#43L" class="nv">argc</a> <span class="o">-</span> <a href="#51L" class="nv">i</a> <span class="o">-</span> <span class="m">1</span><span class="p">;</span></span>
<span id="82L" class="Ln">            <a href="#50L" class="nv">foundCmd</a> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></span>
<span id="83L" class="Ln">            <a href="#51L" class="nv">i</a> <span class="o">=</span> <a href="#43L" class="nv">argc</a><span class="p">;</span></span>
<span id="84L" class="Ln">            <span class="k">break</span><span class="p">;</span></span>
<span id="85L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><span class="nf">strcmp</span><span class="p">(</span><a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">,</span> <span class="s">"--db"</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span></span>
<span id="86L" class="Ln">            <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::compilationDbDir" class="vi">compilationDbDir</a> <span class="o">=</span> <a href="#getOptVal:const-char*const*" class="nf">getOptVal</a><span class="p">(</span><a href="#43L" class="nv">argv</a> <span class="o">+</span> <a href="#51L" class="nv">i</a><span class="o">++</span><span class="p">)</span><span class="p">;</span></span>
<span id="87L" class="Ln">            <a href="#50L" class="nv">foundCmd</a> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></span>
<span id="88L" class="Ln">            <span class="o">++</span><a href="#51L" class="nv">i</a><span class="p">;</span></span>
<span id="89L" class="Ln">            <span class="k">break</span><span class="p">;</span></span>
<span id="90L" class="Ln">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></span>
<span id="91L" class="Ln">            <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/string/basic_string" class="nc">string</a><span class="p">(</span><span class="s">"Bad argument "</span><span class="p">)</span> <span class="p">+</span> <a href="#43L" class="nv">argv</a><span class="p">[</span><a href="#51L" class="nv">i</a><span class="p">]</span><span class="p">)</span><span class="p">;</span></span>
<span id="92L" class="Ln">        <span class="p">}</span></span>
<span id="93L" class="Ln">    <span class="p">}</span></span>
<span id="94L" class="Ln"></span>
<span id="95L" class="Ln">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="#50L" class="nv">foundCmd</a><span class="p">)</span></span>
<span id="96L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Missing command."</span><span class="p">)</span><span class="p">;</span></span>
<span id="97L" class="Ln">    <span class="k">if</span> <span class="p">(</span><a href="#51L" class="nv">i</a> <span class="o">!=</span> <a href="#43L" class="nv">argc</a><span class="p">)</span></span>
<span id="98L" class="Ln">        <span class="k">throw</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/error/runtime_error" class="nc">runtime_error</a><span class="p">(</span><span class="s">"Superfluous commandline arguments."</span><span class="p">)</span><span class="p">;</span></span>
<span id="99L" class="Ln"></span>
<span id="100L" class="Ln">    <span class="k">if</span> <span class="p">(</span><a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::nThreads" class="vi">nThreads</a> <span class="o">==</span> <span class="m">0</span><span class="p">)</span></span>
<span id="101L" class="Ln">        <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::nThreads" class="vi">nThreads</a> <span class="o">=</span> <a href="http://en.cppreference.com/w/" class="nn">std</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/thread/thread" class="nc">thread</a><span class="p">::</span><a href="http://en.cppreference.com/w/cpp/thread/thread/hardware_concurrency" class="nf">hardware_concurrency</a><span class="p">(</span><span class="p">)</span><span class="p">;</span></span>
<span id="102L" class="Ln">    <span class="k">for</span> <span class="p">(</span><span class="kd">auto</span><span class="p">&amp;</span> <span class="def decl nv">dir</span> <a href="#102L" class="p">:</a> <a href="#47L" class="nv">r</a><span class="p">.</span><a href="cmdline.hpp.html#synth::CmdLineArgs::inOutDirs" class="vi">inOutDirs</a><span class="p">)</span> <span class="p">{</span></span>
<span id="103L" class="Ln">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><a href="#102L" class="nv">dir</a><span class="p">.</span><span class="vi">second</span><span class="p">)</span></span>
<span id="104L" class="Ln">            <a href="#102L" class="nv">dir</a><span class="p">.</span><span class="vi">second</span> <span class="o">=</span> <span class="s">"."</span><span class="p">;</span></span>
<span id="105L" class="Ln">    <span class="p">}</span></span>
<span id="106L" class="Ln"></span>
<span id="107L" class="Ln">    <span class="k">return</span> <a href="#47L" class="nv">r</a><span class="p">;</span></span>
<span id="108L" class="Ln"><span class="p">}</span></span>
<span id="109L" class="Ln"></span>
</pre></div>
        <script src="../code.js"></script>
    </body>
</html>
